<html>
	<head>
		<title>Praat-Py: Extended Praat for Python Scripting</title>
		<style>
			.section { margin-left: 2em }
			.code { background-color: #EFEFEF; padding: .5em; border: 1px solid #DDDDDD; }
			code { font-weight: bold; font-size: 110%; letter-spacing: .33px; }
		</style>
	</head>
	
	<body>

<h1>Praat-Py: Extended Praat for Python Scripting</h1>

<p>By Joshua Tauberer &lt;<a href="http://razor.occams.info">http://razor.occams.info</a>&gt;</p>

<h2>Introduction</h2>
<div class="section">
<p>This project is an extension to <a href="http://www.fon.hum.uva.nl/praat/">Praat</a>,
a computer program for doing phonetic analysis on sound files used
by linguists, to allow for scripts to be written in the Python programming
language, rather than in Praat's built-in language.</p>

<p>The motivation for this extension is to remove the need for Praat Script writers to
learn an entirely new programming language if they already know Python.
Additionally, Python is a more complete programming language and so scripts of any complexity should be
more easily written in Python.</p>

<p>All of the functionality of Praat's scripting language is (meant to) be retained
when using Python.  However, forms are not implemented yet.</p>

<p>This project is released under the same terms as Praat itself,
the GPL v2 or later.</p>

<p>Praat-Py works by embedding the <a href="http://www.mono-project.com">Mono</a> .NET runtime and the <a href="http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython">IronPython</a> engine into Praat.</p>
(It is also possible to compile the extension to use JavaScript using <a href="http://www.mozilla.org/rhino/">Rhino</a>,
but this is off by default.)</div>

<h2>Example</h2>


<div class="section">
<p>The following is an example script for Praat written in Python,
and on the right is the corresponding script in Praat Script.</p>

<p>The script draws a sepctrum for a 40 ms window around the cursor
in the sound editor window.  The script (and this description) are
based on the script <a href="http://www.helsinki.fi/~lennes/praat-scripts/public/draw_spectrum_from_selection.praat">here</a>
by Mietta Lennes.</p>

<table border="1" cellpadding="10">
<tr><th>Python (with Praat-Py)</th> <th>Praat Script (with Praat-Py or regular Praat)</th></tr>

<tr valign="top">
<td>
<pre>#python
# Make a temporary selection from the original sound:
cursor = praat.getNum("Get cursor")
start = cursor - 0.02
end = cursor + 0.02
praat.go("Select...", start, end)

# name the new Sound object according to the time point
# where the cursor was
milliseconds = int(cursor * 1000)
objName = "FFT_" + str(milliseconds) + "ms"
praat.go("Extract windowed selection...", objName, "Kaiser2", "2", "no")

# leave the Sound editor for a while to calculate and draw
# the spectrum
praat.go("endeditor")

# Make the Spectrum object from the new Sound
praat.go("To Spectrum")
praat.go("Edit")
praat.go("editor", "Spectrum " + objName)
# zoom the spectrum to a comfortable frequency view...
praat.go("Zoom...", 0, 5000)
praat.go("endeditor")

# select and remove the temporary Sound object 
praat.select("Sound " + objName)
praat.go("Remove")

# return to the Sound editor window and recall the original
# cursor position
praat.go("editor")
praat.go("Move cursor to...", cursor)</pre>
</td>

<td>
<pre># Make a temporary selection from the original sound:

cursor = Get cursor
start = cursor - 0.02
end = cursor + 0.02
Select... start end

# name the new Sound object according to the time point
# where the cursor was
milliseconds = round (cursor * 1000)

Extract windowed selection... FFT_'milliseconds'ms Kaiser2 2 no

# leave the Sound editor for a while to calculate and draw
# the spectrum
endeditor

# Make the Spectrum object from the new Sound
To Spectrum
Edit
editor Spectrum FFT_'milliseconds'ms
# zoom the spectrum to a comfortable frequency view...
Zoom... 0 5000
endeditor

# select and remove the temporary Sound object 
select Sound FFT_'milliseconds'ms
Remove

# return to the Sound editor window and recall the original
# cursor position
editor
Move cursor to... cursor</pre>
</td>
</tr>
</table>
</div>



<h2>Getting Started</h2>

<h3>Downloading Praat-Py</h3>
<div class="section">
<p>Praat-Py is a replacement for the Praat executable file you downloaded from the Praat website.  I provide a ready-to-go version of Praat-Py only for certain operating systems because that is what I have available to create it for.</p>

<p>You will need to have Mono installed, the open-source implementation
of the Microsoft .NET Framework.  Grab it <a href="http://mono-project.com/Downloads">from here</a>.</p>

<p>The ready-to-go Praat-Py downloads here are currently based on:</p>
	<div style="margin-left: 2em">
	<div><b>Praat version 4.5.09 (January 8, 2007)</b></div>
	<div style="margin: .5em">and</div>
	<div><b>Praat-Py version 0.1 (January 11, 2007)</b></div>
	</div>

<p>Linux i386: <a href="dist/praat-py_linux_i386">praat-py_linux_i386</a></p>

<p>Windows: <a href="dist/praat-py.exe">praat-py.exe</a></p>

<p>If none of these downloads are useful to you, you will need to build Praat-Py from its source files.  (Experienced users only.)  Instructions are below.</p>
</div>



<h3>Using Python in Praat-Py</h3>
<div class="section">

	<p>Once you have Praat-Py, you can write scripts in Python rather than Praat's own scripting language.  You should be roughly familiar with Praat scripting before reading on (see <a href="http://www.fon.hum.uva.nl/praat/manual/Scripting.html">this page</a>).  To script with Python, all you have to do is start your scripts with this:</p>
	
	<pre class="code">#python</pre>
	
	<p>That is, the very first line of your script must be a hash (#) followed immediately by the word "python" in lowercase letters.  This instructs Praat to interpret the remainder of your script as Python code.</p>
	
	<p>There are several ways your Python script can make Praat do things.  The first way is via the <code>print</code> Python command, which will output a string to the Praat Info window:</p>

	<pre class="code">#python
print 11500 * 20</pre>

	<p>The next way is to have Praat do something.  You do this with the <code>praat.go(<i>command</i>, <i>arguments...</i>)</code> function.</p>
	
	<pre class="code">#python
praat.go("select", "LongSound en_4813_B")
praat.go("To Spectrogram...", .005, 5000, .002, 20, "Gaussian")
praat.go("View")</pre>

	<p>The first argument to the <code>praat.go</code> function is the name of a command on a Praat menu to run.  The remaning arguments are any options that that command takes, in the order that they show up in Praat.</p>

	<p>The third way is to have Praat do something but to capture the result of what it does.  You can capture numeric results with <code>praat.getNum(<i>command</i>, <i>arguments...</i>)</code>:</p>

	<pre class="code">#python
print "The start time is: ", praat.getNum("Get end time")*1000, " (ms)"</pre>

	<p>As in regular Praat scripts, this works by capturing the first number the command would normally print to Praat's Info window.  As with <code>praat.go</code>, you can provide any number of arguments to <code>praat.getNum</code></p>
	
	<p>There is also a function <code>praat.getString</code> which works like <code>praat.getNum</code> but it returns the entire output line sent to the Info window by the command.</p>
	
	<p>Two additional commands are provided to make it easier to work with Praat's selected objects.  <code>praat.select(<i>object name</i>)</code> selects an object by its name.  <code>praat.selected()</code> returns the name of the selected object.</p>
	
	<pre class="code">#python
praat.select("Sound mysound")
print praat.selected() # prints "LongSound mysound"</pre>
</div>



<h2>Building Praat with Praat-Py from Sources</h2>
<div class="section">

<p>Building Praat-Py only works on Linux at the moment.</p>

<p>You will need to have Mono installed, the open-source implementation
of the .NET Framework.  Grab it <a href="http://mono-project.com/Downloads">from here</a>.  (If
installing from an RPM, you will need the mono-devel package too.  Once it's built, you don't need the devel package.)</p>

<p>1)  Get <a href="http://www.fon.hum.uva.nl/praat/download_sources.html">the
Praat sources</a> and follow the instructions to build Praat on
your platform.  (You don't really need to build Praat
now, but it would be a really good idea to make sure it builds before
going forward.)</p>

<p>2) In the Praat sources directory (i.e. <tt>sources_4430</tt> or
something similar), make a new directory called <tt>scripting</tt>
and unzip the <a href="dist/praat-py.zip">Praat-Py ZIP package</a> above into that directory.</p>

<pre class="code">
$ mkdir scripting
$ cd scripting
$ unzip praat-py.zip
</pre>

<p>Alternatively, you can check out the SVN module <tt>svn://razor.occams.info/praat-py</tt> <i>as</i> the scripting directory.</p>

<p>The Praat sources must be patched to build Praat-Py and to invoke the
Python interpreter instead of the Praat script interpreter
when the script begins with the magic string "#python".  Do this to patch your Praat source files:</p>

<pre class="code">
$ make patch-praat
</pre>

<p>Then exit out of the <tt>scripting</tt> directory and build Praat.</p>

<pre class="code">
cd ..
make
</pre>

<p>The <tt>praat</tt> executable in the current directory will
now be a lot larger, and it will support Python scripts now.</p>
</div>

	</body>
</html>
